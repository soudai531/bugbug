(()=>{"use strict";const e=document.querySelector(".header"),t=document.querySelector(".logo"),n=document.querySelector(".siteExpl"),i=document.querySelector(".insectFilterBtn"),a=document.querySelector(".navBtns"),o=document.querySelectorAll(".navBtns__btn"),_=document.querySelectorAll(".navBtns__btn__text"),c=()=>{i.remove(),a.remove()},s=[e,t,n,i,a,...o,..._],r=()=>{const e=document.querySelector(".main");if(10>document.documentElement.scrollTop)for(let t of Object.values(s))t.classList.remove("js-headerScrollOn"),e.classList.remove("js-headerScrollOn");else if(!s[0].classList.contains("js-headerScrollOn"))for(let t of Object.values(s))t.classList.add("js-headerScrollOn"),e.classList.add("js-headerScrollOn")},l=/^[a-zA-Z0-9_+-]+(.[a-zA-Z0-9_+-]+)*@([a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]*\.)+[a-zA-Z]{2,}$/,d=/(.*[a-zA-Z])(?=.*[0-9])[a-zA-z0-9]{6,}/,m=(e,t)=>{const n=document.querySelector(".validation__blank");let i=!1;for(let e of t)""===e.value.trim()?(e.classList.add("validationError"),i=!0):e.classList.remove("validationError"),e.addEventListener("input",(()=>{if(""!==e.value.trim()){e.classList.remove("validationError");let i=!0;for(let e of t)""===e.value.trim()&&(i=!1);i&&n.classList.add("hidden")}else e.classList.add("validationError"),n.classList.remove("hidden")}));return i?(n.classList.remove("hidden"),e.preventDefault(),e.stopImmediatePropagation(),!1):(n.classList.add("hidden"),!0)},u=(e,t)=>{const n=document.querySelector(".validation__email");let i=!1;return l.test(t.value.trim())||(i=!0),t.addEventListener("input",(()=>{l.test(t.value.trim())?(t.classList.remove("validationError"),n.classList.add("hidden")):(t.classList.add("validationError"),n.classList.remove("hidden"))})),i?(n.classList.remove("hidden"),t.classList.add("validationError"),t.value="",e.preventDefault(),e.stopImmediatePropagation(),!1):(n.classList.add("hidden"),!0)},g=e=>{e.classList.add("hidden")},p=e=>{e.classList.remove("hidden")},v=e=>{e.classList.add("active")},S=e=>{e.classList.remove("active")},f=document.querySelector(".search__form__cover"),b=document.querySelector(".search__form__close"),h=document.querySelector(".search__form"),y=document.querySelector(".navBtns__btn--searchRecipe"),L=(e,t)=>{document.querySelector("header").insertAdjacentHTML("afterend",'\n    <div class="confirmDialog__cover"></div>\n  '),document.querySelector(e).insertAdjacentHTML("afterend",(e=>`\n    <div class="confirm">\n      <span class="confirm__message">${e}</span>\n      <div class="confirm__btns">\n        <button class="confirm__btns__btn confirm__btns__btn--yes" type="submit">はい</button>\n        <button class="confirm__btns__btn confirm__btns__btn--cancel" type="button">キャンセル</button>\n      </div>\n    </div>\n  `)(t));const n=document.querySelector(".confirm__btns__btn--cancel"),i=document.querySelector(".confirmDialog__cover");n.addEventListener("click",(()=>{document.querySelector(e).nextElementSibling.remove(),i.remove()})),i.addEventListener("click",(()=>{document.querySelector(e).nextElementSibling.remove(),i.remove()}))},q=(e,t)=>{const n=document.querySelectorAll(e);for(let i of n)i.addEventListener("click",(()=>{L(e,t)})),i.addEventListener("submit",(()=>!1))},E=()=>{const e=document.querySelectorAll(".recipeSection");for(let t of e)t.children[0].addEventListener("click",(()=>{location.href=t.dataset.recipeHref})),t.children[1].addEventListener("click",(()=>{location.href=t.dataset.recipeHref})),t.children[2].addEventListener("click",(()=>{location.href=t.dataset.recipeHref}))},I=async(e,t,n,i)=>{const a={state:e,beforeHeartNum:t,afterHeartNum:n,recipeId:i};console.log(a)},w=()=>{const e=document.querySelectorAll(".heartBtn");for(let t of e)t.addEventListener("click",(()=>{const e=t.firstElementChild,n=t.lastElementChild;"heart-outline"==e.name?(e.name="heart",I(!0,parseInt(n.textContent),parseInt(n.textContent)+1,parseInt(t.dataset.recipeId)),n.textContent=+n.textContent+1):(e.name="heart-outline",I(!1,parseInt(n.textContent),parseInt(n.textContent)-1,parseInt(t.dataset.recipeId)),n.textContent=+n.textContent-1)}))},B=()=>{const e=document.querySelector(".insectFilterBtn__label"),t=document.querySelectorAll(".recipeImage");e.addEventListener("click",(()=>{for(let e of t)e.classList.toggle("filter")}))},k=(e,t)=>{const[n]=e.target.files;n&&t.setAttribute("src",URL.createObjectURL(n))},x=document.querySelector(".registerRecipe__tags"),A=document.querySelector(".tag__select__list"),j=document.querySelector(".tag__input");let $=1;const C=()=>{$++},R=()=>$,H=()=>j.value,T=e=>{A.classList.toggle("hidden"),e.classList.toggle("open"),e.classList.contains("open")?e.textContent="閉じる":e.textContent="一覧から選ぶ"},M=e=>{x.insertAdjacentHTML("beforeend",(e=>`\n    <span class="registerRecipe__tag" id="tagId_${R()}">\n      <input class="registerRecipe__tag__value" type="hidden" name="tags" value="${e.textContent}" />\n      <span class="registerRecipe__tag__name"><span>#</span>${e.textContent}</span>\n      <button class="registerRecipe__tag__deleteBtn" type="button" data-tag-id="tagId_${R()}">\n        <ion-icon name="trash-outline"></ion-icon>\n      </button>\n    </span>\n  `)(e));const t=x.querySelector(`button[data-tag-id="tagId_${R()}"]`);t.addEventListener("click",(()=>{t.parentNode.remove()})),C()},O=document.querySelector(".registerRecipe__materials__list");let z=1;const D=()=>z,N=()=>{O.insertAdjacentHTML("beforeend",`\n    <li class="material" id="matarialId_${D()}">\n      <input class="material__name" type="text" name="materials" placeholder="材料名" />\n      <input class="material__amount" type="text" name="amounts" placeholder="数量" />\n      <button class="material__deleteBtn" type="button" data-material-id="materialId_${D()}">\n        <ion-icon name="trash-outline"></ion-icon>\n      </button>\n    </li>\n  `);const e=O.querySelector(`button[data-material-id="materialId_${D()}"]`);e.addEventListener("click",(()=>{O.children.length<=1||e.parentNode.remove()})),z++},Z=document.querySelector(".registerRecipe__howto__list");let F=1;const P=()=>F,V=()=>{Z.insertAdjacentHTML("beforeend",`\n    <div class="howto" id="howtoId_${P()}">\n      <div class="howto__action">\n        <span class="howto__num">${Z.children.length+1}</span>\n        <button class="howto__deleteBtn" type="button" data-howto-id="howtoId_${P()}">\n          <ion-icon name="trash-outline"></ion-icon>\n        </button>\n      </div>\n      <div class="howto__item">\n        <label class="howto__image__input__label">\n          <span class="howto__image__input__label__text">画像を選択</span>\n          <input class="howto__image__input" type="file" name="procedureImages" accept="image/jpeg,image/png" />\n        </label>\n        <div class="howto__image" style="height: 40px">\n          <img class="howto__image__preview" />\n          <button class="howto__image__deleteBtn hidden" type="button">\n            <ion-icon name="trash-outline"></ion-icon>\n          </button>\n        </div>\n        <textarea class="howto__text" name="contexts" placeholder="作り方を入力"></textarea>\n      </div>\n    </div>\n  `);const e=Z.querySelector(`#howtoId_${P()}`);e.querySelector(".howto__deleteBtn").addEventListener("click",(()=>{Z.children.length<=1||(e.remove(),(()=>{for(let[e,t]of Object.entries(Z.children))t.querySelector(".howto__num").textContent=+e+1})())}));const t=e.querySelector(".howto__image"),n=e.querySelector(".howto__image__input"),i=t.firstElementChild,a=t.lastElementChild;n.addEventListener("change",(()=>{t.style.height="100px",k(event,i),p(a)})),a.addEventListener("click",(()=>{t.style.height="40px",i.src="",n.value="",g(a)})),F++},U=(e,t,n)=>{return`\n    <form class="acountSetting__form" action="/users/${t}/${"icon"==e?"user-icon":"mail"==e?"user-mail":"user-name"}/update" enctype="multipart/form-data" method="post">\n      ${"icon"==e?(o=n,`\n    <div class="acountSetting__form__iconImage acountSetting__form__iconImage--before">\n      <span class="acountSetting__form__iconImage__title acountSetting__form__iconImage__title--before">変更前</span>\n      <span class="acountSetting__form__iconImage__preview acountSetting__form__iconImage__preview--before">\n        <img src="/images/user-icons/${o}">\n      </span>\n    </div>\n    <span class="acountSetting__form__iconImage__Arrow">\n      <ion-icon name="caret-down-outline"></ion-icon>\n    </span>\n    <div class="acountSetting__form__iconImage acountSetting__form__iconImage--after">\n      <span class="acountSetting__form__iconImage__title acountSetting__form__iconImage__title--after">変更後</span>\n      <span class="acountSetting__form__iconImage__preview acountSetting__form__iconImage__preview--after">\n        <ion-icon name="image-outline"></ion-icon>\n        <img>\n      </span>\n      <label class="acountSetting__form__iconImage__preview__input__label">\n        <span class="acountSetting__form__iconImage__preview__input__label__text">画像を変更</span>\n        <input class="acountSetting__form__iconImage__preview__input" type="file" name="file" accept="image/jpeg,image/png" />\n      </label>\n    </div>\n  `):"mail"==e?(a=n,`\n    <div class="acountSetting__form__mail acountSetting__form__mail--before">\n      <span class="acountSetting__form__mail__title acountSetting__form__mail__title--before">現在のメールアドレス</span>\n      <span class="acountSetting__form__mail__input acountSetting__form__mail__input--before">${a}<span>\n    </div>\n    <div class="acountSetting__form__mail acountSetting__form__mail--after">\n      <span class="acountSetting__form__mail__title acountSetting__form__mail__title--after">新しいメールアドレス</span>\n      <input class="acountSetting__form__mail__input acountSetting__form__mail__input--after" type="email" name="mail" placeholder="新しいメールアドレスを入力" />\n    </div>\n  `):(i=n,`\n    <div class="acountSetting__form__username acountSetting__form__username--before">\n      <span class="acountSetting__form__username__title acountSetting__form__username__title--before">現在のユーザーネーム</span>\n      <span class="acountSetting__form__username__input acountSetting__form__username__input--before">${i}<span>\n    </div>\n    <div class="acountSetting__form__username acountSetting__form__username--after">\n      <span class="acountSetting__form__username__title acountSetting__form__username__title--after">新しいユーザーネーム</span>\n      <input class="acountSetting__form__username__input acountSetting__form__username__input--after" type="text" name="name" placeholder="新しいユーザーネームを入力" />\n    </div>\n  `)}\n      <button class="acountSetting__form__btn" type="submit">送信</button>\n    </form>\n  `;var i,a,o},G=e=>{for(let t of Object.values(e.children))g(t)},J=e=>{for(let t of Object.values(e.children))p(t)},K=e=>{g(e)},Q=e=>{p(e)};y.addEventListener("click",(()=>{p(f),p(h)})),f.addEventListener("click",(()=>{g(f),g(h)})),b.addEventListener("click",(()=>{g(f),g(h)})),["/bugbug/","/","/index","/index.html"].includes(location.pathname)&&((()=>{for(let e of Object.values(s))e.classList.remove("js-headerScrollOn");window.addEventListener("scroll",r)})(),E(),w(),B()),["/login/form","/login"].includes(location.pathname)&&(c(),(()=>{const e=document.querySelector(".login__form"),t=document.querySelectorAll(".form__input");e.addEventListener("submit",(n=>{m(n,t),u(n,e.mail)}))})()),["/signup/form","/signup"].includes(location.pathname)&&(c(),(()=>{const e=document.querySelector(".signup__form"),t=document.querySelectorAll(".form__input");document.querySelector(".signup__form__btn").addEventListener("click",(n=>{m(n,t),((e,t)=>{const n=document.querySelector(".validation__password");let i=!1;d.test(t.value.trim())||(i=!0),t.addEventListener("input",(()=>{d.test(t.value.trim())?(t.classList.remove("validationError"),n.classList.add("hidden")):(t.classList.add("validationError"),n.classList.remove("hidden"))})),i?(n.classList.remove("hidden"),t.classList.add("validationError"),t.value="",e.preventDefault(),e.stopImmediatePropagation()):n.classList.add("hidden")})(n,e.password),((e,t,n)=>{const i=document.querySelector(".validation__confirm");let a=!1;t.value.trim()!==n.value.trim()&&(a=!0),t.addEventListener("input",(()=>{i.classList.add("hidden")})),n.addEventListener("input",(()=>{i.classList.add("hidden")})),a?(i.classList.remove("hidden"),n.classList.add("validationError"),n.value="",e.preventDefault(),e.stopImmediatePropagation()):i.classList.add("hidden")})(n,e.password,e.confirmPassword),u(n,e.mail)}))})(),q(".signup__form__btn","この内容で登録しますか")),["/recipes/register","/recipes/register/form"].includes(location.pathname)&&((()=>{const e=document.querySelector(".registerRecipe__image__input"),t=document.querySelector(".registerRecipe__image__preview");e.addEventListener("change",(()=>{k(event,t)}))})(),(()=>{const e=document.querySelector(".tag__select__btn");e.addEventListener("click",(()=>{T(e)}));const t=A.firstElementChild.children;for(let n of t)n.addEventListener("click",(()=>{M(n),T(e)}));document.querySelector(".tag__addBtn").addEventListener("click",(()=>{(()=>{x.insertAdjacentHTML("beforeend",`\n    <span class="registerRecipe__tag" id="tagId_${R()}">\n      <input class="registerRecipe__tag__value" type="hidden" name="tags" value="${H()}" />\n      <span class="registerRecipe__tag__name"><span>#</span>${H()}</span>\n      <button class="registerRecipe__tag__deleteBtn" type="button" data-tag-id="tagId_${R()}">\n        <ion-icon name="trash-outline"></ion-icon>\n      </button>\n    </span>\n  `);const e=x.querySelector(`button[data-tag-id="tagId_${R()}"]`);e.addEventListener("click",(()=>{e.parentNode.remove()})),j.value="",C()})()}))})(),(()=>{for(let e=0;e<3;e++)N()})(),document.querySelector(".material__addBtn").addEventListener("click",(()=>{N()})),(()=>{for(let e=0;e<2;e++)V()})(),document.querySelector(".howto__addBtn").addEventListener("click",(()=>{V()})),q(".registerRecipe__submitBtn","この内容で登録しますか")),["/mypage"].includes(location.pathname)&&((()=>{const e=document.querySelector(".tabChangeBtn--myRecipe"),t=document.querySelector(".tabChangeBtn--myFavRecipe"),n=document.querySelector(".tabChangeBtn__line"),i=document.querySelector(".myRecipe__list"),a=document.querySelector(".myFavRecipe__list");e.addEventListener("click",(()=>{g(a),p(i),v(e),S(t),n.className="tabChangeBtn__line myRecipe"})),t.addEventListener("click",(()=>{g(i),p(a),v(t),S(e),n.className="tabChangeBtn__line myFavRecipe"}))})(),(()=>{const e=document.querySelector(".acountSettingBtn"),t=document.querySelector(".userInfoValue--id"),n=document.querySelector(".userInfoValue--icon"),i=document.querySelector(".userInfoValue--name"),a=document.querySelector(".userInfoValue--mail");e.addEventListener("click",(()=>((e,t,n,i)=>{document.querySelector("header").insertAdjacentHTML("afterend",((e,t,n,i)=>`\n    <section class="acountSetting">\n      <button class="acountSetting__closeBtn" type="button">\n        <span>閉じる</span>\n        <ion-icon name="close-outline"></ion-icon>\n      </button>\n      <span class="acountSetting__title">アカウント設定</span>\n      <div class="acountSetting__items">\n        <div class="acountSetting__items__item acountSetting__items__item--icon">\n          <span class="acountSetting__items__item__title acountSetting__items__item__title--icon">アイコン</span>\n          <div class="acountSetting__items__item__parts">\n            <span class="acountSetting__icon__image">\n              <img src="/images/user-icons/${t}" />\n            </span>\n            <button class="acountSetting__items__item__editBtn acountSetting__items__item__editBtn--icon">\n              <ion-icon name="pencil"></ion-icon>\n            </button>\n          </div>\n        </div>\n        <div class="acountSetting__items__item acountSetting__items__item--mail">\n          <span class="acountSetting__items__item__title acountSetting__items__item__title--mail">メールアドレス</span>\n          <div class="acountSetting__items__item__parts">\n            <span class="acountSetting__items__item__text acountSetting__items__item__text--mail">\n              ${i}\n            </span>\n            <button class="acountSetting__items__item__editBtn acountSetting__items__item__editBtn--mail">\n              <ion-icon name="pencil"></ion-icon>\n            </button>\n          </div>\n        </div>\n        <div class="acountSetting__items__item acountSetting__items__item--username">\n          <span class="acountSetting__items__item__title acountSetting__items__item__title--username">ユーザーネーム</span>\n          <div class="acountSetting__items__item__parts">\n            <span class="acountSetting__items__item__text acountSetting__items__item__text--username">\n              ${n}\n            </span>\n            <button class="acountSetting__items__item__editBtn acountSetting__items__item__editBtn--username">\n              <ion-icon name="pencil"></ion-icon>\n            </button>\n          </div>\n        </div>\n        <div class="acountSetting__items__item acountSetting__items__item--password">\n          <span class="acountSetting__items__item__title acountSetting__items__item__title--password">パスワード</span>\n          <div class="acountSetting__items__item__parts">\n            <span class="acountSetting__items__item__text acountSetting__items__item__text--password">\n              ***********\n            </span>\n            <a class="acountSetting__items__item__editBtn acountSetting__passwordChangeBtn">\n              パスワードを変更\n            </a>\n          </div>\n        </div>\n      </div>\n      <a class="acountSetting__logoutBtn" href="/users/${e}/logout">ログアウト</a>\n    </section>\n  `)(e,t,n,i)),document.querySelector("header").insertAdjacentHTML("afterend",'\n    <div class="acountSetting__cover"></div>\n  ');const a=document.querySelector(".acountSetting__cover"),o=document.querySelector(".acountSetting");o.querySelector(".acountSetting__closeBtn").addEventListener("click",(()=>{o.remove(),a.remove()})),((e,t,n,i,a)=>{const o=e.querySelector(".acountSetting__items"),_=e.querySelector(".acountSetting__logoutBtn");e.querySelector(".acountSetting__items__item__editBtn--icon").addEventListener("click",(()=>{G(o),K(_),o.insertAdjacentHTML("beforeend",U("icon",t,n)),e.querySelector(".acountSetting__form__iconImage__preview__input").addEventListener("change",(()=>{const t=e.querySelector(".acountSetting__form__iconImage__preview--after").lastElementChild;k(event,t)})),e.insertAdjacentHTML("afterbegin",'\n    <button class="acountSetting__backBtn" type="button">\n      <ion-icon name="caret-back-outline"></ion-icon>\n      <span>戻る</span>\n    </button>\n  ');const i=document.querySelector(".acountSetting__backBtn");i.addEventListener("click",(()=>{document.querySelector(".acountSetting__form").remove(),i.remove(),J(o),Q(_)}))})),e.querySelector(".acountSetting__items__item__editBtn--mail").addEventListener("click",(()=>{G(o),K(_),o.insertAdjacentHTML("beforeend",U("mail",t,a)),e.insertAdjacentHTML("afterbegin",'\n    <button class="acountSetting__backBtn" type="button">\n      <ion-icon name="caret-back-outline"></ion-icon>\n      <span>戻る</span>\n    </button>\n  ');const n=document.querySelector(".acountSetting__backBtn");n.addEventListener("click",(()=>{document.querySelector(".acountSetting__form").remove(),n.remove(),J(o),Q(_)}))})),e.querySelector(".acountSetting__items__item__editBtn--username").addEventListener("click",(()=>{G(o),K(_),o.insertAdjacentHTML("beforeend",U("username",t,i)),e.insertAdjacentHTML("afterbegin",'\n    <button class="acountSetting__backBtn" type="button">\n      <ion-icon name="caret-back-outline"></ion-icon>\n      <span>戻る</span>\n    </button>\n  ');const n=document.querySelector(".acountSetting__backBtn");n.addEventListener("click",(()=>{document.querySelector(".acountSetting__form").remove(),n.remove(),J(o),Q(_)}))}))})(o,e,t,n,i)})(t.value,n.value,i.value,a.value))),t.remove(),n.remove(),i.remove(),a.remove()})(),E(),w(),B(),q(".recipeAction__btn--delete","削除しますか")),/^\/recipes\/[0-9]*$/.test(location.pathname)&&((()=>{const e=document.querySelectorAll(".howto__image");for(let t of Object.values(e))null==t.firstElementChild&&(t.style.height="0",t.style.marginBottom="0")})(),w(),B(),q(".recipeDetail__recipeAction__btns__btn--delete","削除しますか"))})();
